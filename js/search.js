"use strict";var searchFunc=function(e,t,n){var l="<a style='color:red' id='local-search-close'>清除</a>",r=document.getElementById(t),a=document.getElementById(n);a.innerHTML=l+"<ul><span class='local-search-empty'>首次搜索，正在载入索引文件，请稍后……<span></ul>",$.ajax({url:e,dataType:"xml",success:function(e){var t=$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get();a.innerHTML="",r.addEventListener("input",function(){var u='<ul class="search-result-list">',h=this.value.trim().toLowerCase().split(/[\s\-]+/);if(a.innerHTML="",!(this.value.trim().length<=0)){if(t.forEach(function(e){var n=!0;e.title&&""!==e.title.trim()||(e.title="Untitled");var l,r,t=e.title.trim(),a=t.toLowerCase(),c=e.content.trim().replace(/<[^>]+>/g,""),s=c.toLowerCase(),e=e.url,i=-1,o=-1;""!==s?h.forEach(function(e,t){l=a.indexOf(e),i=s.indexOf(e),l<0&&i<0?n=!1:(i<0&&(i=0),0==t&&(o=i))}):n=!1,n&&(u+="<li><a href='"+e+"' class='search-result-title' target='_blank'>"+t+"</a>",0<=o&&(r=c.substr(0,50),h.forEach(function(e){var t=new RegExp(e,"gi");r=r.replace(t,"<span style='color: red' class=\"search-keyword\">"+e+"</span>")}),u+='<p class="search-result">'+r+"...</p>"),u+="</li>")}),-1===(u+="</ul>").indexOf("<li>"))return a.innerHTML=l+"<ul><span class='local-search-empty'>没有找到内容，请尝试更换检索词。<span></ul>";a.innerHTML=l+u}})}}),$(document).on("click","#local-search-close",function(){$("#local-search-input").val(""),$("#local-search-result").html("")})},getSearchFile=function(){searchFunc("/search.xml","local-search-input","local-search-result")},inputArea=document.querySelector("#local-search-input");inputArea.onclick=function(){getSearchFile(),this.onclick=null},inputArea.onkeydown=function(){if(13==event.keyCode)return!1};